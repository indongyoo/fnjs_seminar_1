<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <title>비동기</title>
  <script src="js/functional.js"></script>
</head>
<body>

<script>
// ------ 2시간 30분

// 1. 비동기 상황을 잘 다루기
  //  - 원하는 순서대로 함수 실행을 나열하는 법 연습
  //  - 재귀 함수 연습
  //  - 리턴 값으로 소통하기
  //  - 표현식 만으로 코딩하는 연습

// 2. reduce를 재귀 + 유명 함수를 이용하여 Promise를 제어할 수 있도록 변경
// 3. go, pipe, map, filter 사용해보기
// 4. cmap

// ------ 3시간

function constant(val) {
  return function() {
    return val;
  }
}
function cmap(list, iter) {
  return map(
    map(list, function(val) { return constant(iter(val)); }),
    function(f) { return f(); });
}
cmap([1, 2, 3], function(val) {
  return Promise.resolve(val + 10);
}).then(console.log);
</script>

<canvas id="canvas1" width="608" height="432"></canvas>

<script>
//  http://www.http2demo.io/
  var infos = [{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_0.png","x":0,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_1.png","x":32,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_2.png","x":64,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_3.png","x":96,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_4.png","x":128,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_5.png","x":160,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_6.png","x":192,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_7.png","x":224,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_8.png","x":256,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_9.png","x":288,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_10.png","x":320,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_11.png","x":352,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_12.png","x":384,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_13.png","x":416,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_14.png","x":448,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_15.png","x":480,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_16.png","x":512,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_17.png","x":544,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_18.png","x":576,"y":0},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_19.png","x":0,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_20.png","x":32,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_21.png","x":64,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_22.png","x":96,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_23.png","x":128,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_24.png","x":160,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_25.png","x":192,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_26.png","x":224,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_27.png","x":256,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_28.png","x":288,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_29.png","x":320,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_30.png","x":352,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_31.png","x":384,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_32.png","x":416,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_33.png","x":448,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_34.png","x":480,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_35.png","x":512,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_36.png","x":544,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_37.png","x":576,"y":48},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_38.png","x":0,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_39.png","x":32,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_40.png","x":64,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_41.png","x":96,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_42.png","x":128,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_43.png","x":160,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_44.png","x":192,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_45.png","x":224,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_46.png","x":256,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_47.png","x":288,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_48.png","x":320,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_49.png","x":352,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_50.png","x":384,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_51.png","x":416,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_52.png","x":448,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_53.png","x":480,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_54.png","x":512,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_55.png","x":544,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_56.png","x":576,"y":96},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_57.png","x":0,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_58.png","x":32,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_59.png","x":64,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_60.png","x":96,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_61.png","x":128,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_62.png","x":160,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_63.png","x":192,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_64.png","x":224,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_65.png","x":256,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_66.png","x":288,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_67.png","x":320,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_68.png","x":352,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_69.png","x":384,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_70.png","x":416,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_71.png","x":448,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_72.png","x":480,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_73.png","x":512,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_74.png","x":544,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_75.png","x":576,"y":144},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_76.png","x":0,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_77.png","x":32,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_78.png","x":64,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_79.png","x":96,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_80.png","x":128,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_81.png","x":160,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_82.png","x":192,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_83.png","x":224,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_84.png","x":256,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_85.png","x":288,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_86.png","x":320,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_87.png","x":352,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_88.png","x":384,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_89.png","x":416,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_90.png","x":448,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_91.png","x":480,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_92.png","x":512,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_93.png","x":544,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_94.png","x":576,"y":192},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_95.png","x":0,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_96.png","x":32,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_97.png","x":64,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_98.png","x":96,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_99.png","x":128,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_100.png","x":160,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_101.png","x":192,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_102.png","x":224,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_103.png","x":256,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_104.png","x":288,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_105.png","x":320,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_106.png","x":352,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_107.png","x":384,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_108.png","x":416,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_109.png","x":448,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_110.png","x":480,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_111.png","x":512,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_112.png","x":544,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_113.png","x":576,"y":240},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_114.png","x":0,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_115.png","x":32,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_116.png","x":64,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_117.png","x":96,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_118.png","x":128,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_119.png","x":160,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_120.png","x":192,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_121.png","x":224,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_122.png","x":256,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_123.png","x":288,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_124.png","x":320,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_125.png","x":352,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_126.png","x":384,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_127.png","x":416,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_128.png","x":448,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_129.png","x":480,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_130.png","x":512,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_131.png","x":544,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_132.png","x":576,"y":288},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_133.png","x":0,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_134.png","x":32,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_135.png","x":64,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_136.png","x":96,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_137.png","x":128,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_138.png","x":160,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_139.png","x":192,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_140.png","x":224,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_141.png","x":256,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_142.png","x":288,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_143.png","x":320,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_144.png","x":352,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_145.png","x":384,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_146.png","x":416,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_147.png","x":448,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_148.png","x":480,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_149.png","x":512,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_150.png","x":544,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_151.png","x":576,"y":336},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_152.png","x":0,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_153.png","x":32,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_154.png","x":64,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_155.png","x":96,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_156.png","x":128,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_157.png","x":160,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_158.png","x":192,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_159.png","x":224,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_160.png","x":256,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_161.png","x":288,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_162.png","x":320,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_163.png","x":352,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_164.png","x":384,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_165.png","x":416,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_166.png","x":448,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_167.png","x":480,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_168.png","x":512,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_169.png","x":544,"y":384},{"url":"https://1906714720.rsc.cdn77.org/http2/tiles_final/tile_170.png","x":576,"y":384}];
  var context = document.getElementById('canvas1').getContext("2d");
  console.time();
  go(
    cmap(infos, function(info) {
      return new Promise(function(resolve) {
        var img = new Image();
        img.onload = function() {
          resolve({
            img: img,
            x: info.x,
            y: info.y
          });
        };
        img.src = info.url;
      });
    }),
    function(infos2) {
      map(infos2, function(info) { context.drawImage(info.img, info.x, info.y, 32, 48); })
    },
    function() {
      console.timeEnd();
    });
</script>

</body>
</html>